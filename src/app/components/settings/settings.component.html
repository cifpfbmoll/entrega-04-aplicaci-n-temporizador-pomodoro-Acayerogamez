<!-- Settings Button -->
<button 
  class="settings-button"
  (click)="openModal()"
  aria-label="Abrir configuración"
  aria-haspopup="dialog">
  <lucide-angular 
    [img]="SettingsIcon" 
    [size]="24"
    aria-hidden="true"></lucide-angular>
  <span>Configuración</span>
</button>

<!-- Modal -->
<div 
  class="modal-overlay" 
  *ngIf="isOpen()"
  (click)="closeModal()"
  role="presentation"
  [attr.aria-hidden]="!isOpen()">
  
  <div 
    class="modal-content"
    (click)="$event.stopPropagation()"
    (keydown)="onKeyDown($event)"
    role="dialog"
    aria-modal="true"
    aria-labelledby="modal-title">
    
    <!-- Modal Header -->
    <div class="modal-header">
      <h2 id="modal-title">Configuración del Temporizador</h2>
      <button 
        class="close-button"
        (click)="closeModal()"
        aria-label="Cerrar configuración">
        <lucide-angular 
          [img]="XIcon" 
          [size]="20"
          aria-hidden="true"></lucide-angular>
      </button>
    </div>

    <!-- Modal Body -->
    <div class="modal-body">
      <form (submit)="$event.preventDefault(); saveSettings()">
        
        <!-- Work Duration -->
        <div class="form-group">
          <label for="work-duration">
            Duración de Sesión de Trabajo
            <span class="unit">(minutos)</span>
          </label>
          <input 
            id="work-duration"
            type="number"
            [value]="workDuration()"
            (input)="onWorkDurationChange($event)"
            min="1"
            max="60"
            aria-describedby="work-duration-desc"
            required>
          <small id="work-duration-desc" class="help-text">
            Tiempo de trabajo concentrado (1-60 minutos)
          </small>
        </div>

        <!-- Short Break Duration -->
        <div class="form-group">
          <label for="short-break">
            Duración de Descanso Corto
            <span class="unit">(minutos)</span>
          </label>
          <input 
            id="short-break"
            type="number"
            [value]="shortBreakDuration()"
            (input)="onShortBreakChange($event)"
            min="1"
            max="60"
            aria-describedby="short-break-desc"
            required>
          <small id="short-break-desc" class="help-text">
            Descanso entre sesiones de trabajo (1-60 minutos)
          </small>
        </div>

        <!-- Long Break Duration -->
        <div class="form-group">
          <label for="long-break">
            Duración de Descanso Largo
            <span class="unit">(minutos)</span>
          </label>
          <input 
            id="long-break"
            type="number"
            [value]="longBreakDuration()"
            (input)="onLongBreakChange($event)"
            min="1"
            max="60"
            aria-describedby="long-break-desc"
            required>
          <small id="long-break-desc" class="help-text">
            Descanso largo después de varias sesiones (1-60 minutos)
          </small>
        </div>

        <!-- Sessions Before Long Break -->
        <div class="form-group">
          <label for="sessions-count">
            Sesiones antes del Descanso Largo
            <span class="unit">(cantidad)</span>
          </label>
          <input 
            id="sessions-count"
            type="number"
            [value]="sessionsBeforeLongBreak()"
            (input)="onSessionsChange($event)"
            min="1"
            max="10"
            aria-describedby="sessions-count-desc"
            required>
          <small id="sessions-count-desc" class="help-text">
            Número de sesiones de trabajo antes del descanso largo (1-10)
          </small>
        </div>
      </form>
    </div>

    <!-- Modal Footer -->
    <div class="modal-footer">
      <button 
        class="btn btn-secondary"
        (click)="closeModal()"
        type="button">
        Cancelar
      </button>
      <button 
        class="btn btn-primary"
        (click)="saveSettings()"
        type="button">
        <lucide-angular 
          [img]="SaveIcon" 
          [size]="18"
          aria-hidden="true"></lucide-angular>
        Guardar Cambios
      </button>
    </div>
  </div>
</div>
